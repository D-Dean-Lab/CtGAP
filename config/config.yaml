indir: input/
outdir: output/

mode: auto # Options: denovo (de novo only) | reference-denovo (ref-guided only) | auto (both methods, selects best)
reference: plurality # [plurality, reference_24, specific reference sequence]
organism: ct # [ct]
resourcesPath: resources/

hostReference: resources/grch38.fasta # [enter the full filename of your host genome]
krakenDB: resources/standardDB
ompaBlastDB: resources/references/ct/ompaBlastDB/ompa21
secondaryBlastDB: "resources/references/ct/secondaryBlastDB/secondary"
mlstDB: resources/references/ct/pubmlst/
hocort_opts: ""
hocort_bowtie2_args: ""
chlamydiales_taxid: 51291

# shovill settings
shovill:
  gsize: "1.04M"
  downsample: 200
# ragtag
ragtag:
  min_len: 500

# ensure conda is used without user having to specify
use_conda: true

# ========== Assembly Filtering ==========
# Removes non-Ct contigs (contamination, artifacts) by aligning to reference

assembly_filter:
  enabled: true  # Set to false to disable post-assembly filtering
  min_identity: 0  # Minimum % identity to Ct reference to keep contig #change as you like
  min_coverage: 30  # Minimum % of contig that must align to reference

# ========== Mixed Strain Detection ==========

mixed_detection:
  enabled: true  # Set to false to disable mixed strain detection
  het_threshold: 50  # Number of heterozygous sites to flag as potential mixed infection
  min_af: 0.15  # Minimum allele frequency for heterozygous-like site
  max_af: 0.85  # Maximum allele frequency for heterozygous-like site
  min_depth: 10  # Minimum read depth at site to consider
  min_base_qual: 20  # Minimum base quality (reduces sequencing errors)
  min_strand_reads: 2  # Minimum reads on each strand (reduces strand bias artifacts)

# ========== Annotation Configuration ==========

annotation:
  enabled: true  # Set to false to disable genome annotation
  min_coverage: 90  # Minimum % genome coverage to trigger annotation (vs 1.043 Mb)

bakta:
  db: "resources/bakta_db/db-light"  # Light DB by default; replace with full DB path if desired
  # Additional bakta options (optional)
  genus: "Chlamydia"
  species: "trachomatis"
  gram: "?"  # Chlamydia cell wall is unusual

# number of cpus used per tool/rule
# These are max values - snakemake will cap based on available resources
threads:
  fastp: 32
  shovill: 24
  spades: 32
  blast: 32
  ragtag: 32
  bowtieindex: 32
  bowtie: 32
  samtools: 32
  mlst: 32
  gap2seq: 32
  bedtools: 32
  ska: 32
  tree: 32
  quast: 32
  dnadiff: 32
  hocort: 32
  kraken: 32
  unicycler: 32
  bakta: 32

# ========== CT Typing Configuration ==========

ct_typing:
  enabled: true  # Set to false to disable CT typing
  
  mash:
    k: 31
    sketch_size: 50000
  
  fastani:
    fragLen: 3000         # Lower for fragmented assemblies
    minFraction: 0.3      # Minimum genome fraction threshold
    threads: 8
  
  thresholds:
    high_ani: 99.95       # ANI ≥ high_ani → "High confidence"
    med_ani: 98.0         # med_ani ≤ ANI < high_ani → "Medium confidence"
  
  decision:
    delta_ani: 0.001      # % difference needed vs runner-up to call unique best
    min_ani_cov: 0.95     # Minimum frags_over/frags_total for "confident"
    min_mash_margin: 5e-5 # Top vs 2nd best Mash distance margin
    require_methods_agree: 2  # Need agreement of ≥2 methods if near-tie

